<link rel="import" href="/betterform/webcomponents/bower_components/polymer/polymer.html">

<!--
    !!! not ready !!!
    This component uses the plain javascript client of atmosphere.
-->
<polymer-element name="better-atmosphere">
    <script>
        Polymer('better-atmosphere', {
            ready: function () {
                console.log("better-atmosphere ready");
                this.socket = atmosphere;

                var request = {
                    url:  '/betterform/msg',
                    contentType: "application/json; charset=UTF-8",
                    trackMessageLength: true,
                    logLevel: 'debug',
                    transport: 'sse',
                    fallbackTransport: 'long-polling'
                };

                request.onOpen = function(response) {
                    console.log('Atmosphere connected using ' + response.transport);
                };

                request.onMessage = function (response) {
                    console.log("response: ",response);
                };

                subSocket = this.socket.subscribe(request);
            },

            sendMessage: function (msg) {

            }
        });
    </script>
</polymer-element>